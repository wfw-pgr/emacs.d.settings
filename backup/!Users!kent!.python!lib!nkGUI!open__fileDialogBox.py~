import os, sys
import tkinter.filedialog
import tkinter.tk as tk


# ========================================================= #
# ===  open__fileDialogBox                              === #
# ========================================================= #
def open__fileDialogBox( self, event=None, filetypes=[("","*")], getDirectoryPath=False, \
                         tkString=False, returnType="path", initDir=None ):

    # ------------------------------------------------- #
    # --- [1] arguments                             --- #
    # ------------------------------------------------- #
    if   ( type( filetypes ) is str ):
        filetypes = [ filetypes ]
    elif ( type( filetypes ) is list ):
        pass
    else:
        filetypes = ["","*"]
    if ( initDir is None ):
        initDir  = os.path.abspath( os.path.dirname( __file__ ) )

    # ------------------------------------------------- #
    # --- [2] call file dialog box                  --- #
    # ------------------------------------------------- #
    import tkinter.filedialog as dialog
    if ( getDirectoryPath ):
        path = dialog.askdirectory   ( initialdir=initDir )
    else:
        path = dialog.askopenfilename( initialdir=initDir, filetypes=filetypes )

    # ------------------------------------------------- #
    # --- [3] store in tkString                     --- #
    # ------------------------------------------------- #
    if   ( tkString is None ):
        tkString = None
    elif ( ( type( tkString ) is bool ) and ( tkString is True ) ):
        tkString = tk.StringVar()
    elif (   type( tkString ) is type( tk.StringVar() ) ):
        pass
    else:
        tkString = None
    if ( tkString is not None ):
        if ( len( path ) == 0 ):
            tkString.set( "No file selection :: cancelled...." )
        else:
            tkString.set( path )

    # ------------------------------------------------- #
    # --- [3] return type                           --- #
    # ------------------------------------------------- #
    if   ( returnType.lower() == "path" ):
        return( path )
    elif ( returnType.lower() == "tk"   ):
        return( tkString )
    elif ( returnType.lower() == "both" ):
        return( path, tkString )
    else:
        return( path )
