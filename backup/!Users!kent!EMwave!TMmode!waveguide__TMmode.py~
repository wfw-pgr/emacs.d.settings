import numpy                     as np
import nkUtilities.equiSpaceGrid as esg

# ------------------------------------------------- #
# --- [1] parameters                            --- #
# ------------------------------------------------- #

mmode       = 0
nmode       = 1
wg_a        = 0.20
tMax        = 0.0
LI          = 51
LJ          = 51
LK          =  1
LT          =  1
omega       = 2.856e9 * 2.0 * np.pi
mu          = 4.0*np.pi*1e-7
epsilon     = 8.85e-12
cv          = 3.0e8
Emn         = 1.0
rho_mn      = 2.405

# ------------------------------------------------- #
# --- [2] grid making                           --- #
# ------------------------------------------------- #

x1MinMaxNum = [ -wg_a, wg_a, LI ]
x2MinMaxNum = [ -wg_a, wg_a, LJ ]
x3MinMaxNum = [ 0.0  , 0.0 , LK ]
grid        = esg.equiSpaceGrid( x1MinMaxNum=x1MinMaxNum, x2MinMaxNum=x2MinMaxNum, \
                                 x3MinMaxNum=x3MinMaxNum, returnType = "point" )
xg          = grid[:,0]
yg          = grid[:,1]
zg          = grid[:,2]
radii       = np.sqrt( grid[:,0]**2 + grid[:,1]**2 )
phi         = np.arctan2( grid[:,1], grid[:,0] )

kc          = rho_mn / wg_a
kcr         = kc     * radii
mphi        = mmode * phi
gamma       = np.sqrt( kc**2 - omega**2 / cv**2 )

# ------------------------------------------------- #
# --- [3] TE mode wave                          --- #
# ------------------------------------------------- #

import scipy.special as special

Ez_Amp      =                                   Emn * special.jv( kcr, mmode   )         * np.cos( mphi )
Hz_Amp      = 0.0 * kcr
Er_Amp      =           gamma         / kc    * Emn * special.jv( kcr, mmode-1 )         * np.cos( mphi )
Ep_Amp      =           gamma * mmode / kc**2 * Emn * special.jv( kcr, mmode   ) / radii * np.sin( mphi )
Hr_Amp      = epsilon * omega * mmode / kc**2 * Emn * special.jv( kcr, mmode   ) / radii * np.sin( mphi )
Hp_Amp      = epsilon * omega         / kc    * Emn * special.jv( kcr, mmode-1 )         * np.cos( mphi )

# ------------------------------------------------- #
# --- [4] colormap of the Amplitude             --- #
# ------------------------------------------------- #

import nkUtilities.cMapTri as cmt
cmt.cMapTri( xAxis=xg, yAxis=yg, cMap=Ex_Amp, pngFile="Ex_Amp.png" )
cmt.cMapTri( xAxis=xg, yAxis=yg, cMap=Ey_Amp, pngFile="Ey_Amp.png" )
cmt.cMapTri( xAxis=xg, yAxis=yg, cMap=Ez_Amp, pngFile="Ez_Amp.png" )
cmt.cMapTri( xAxis=xg, yAxis=yg, cMap=Hx_Amp, pngFile="Hx_Amp.png" )
cmt.cMapTri( xAxis=xg, yAxis=yg, cMap=Hy_Amp, pngFile="Hy_Amp.png" )
cmt.cMapTri( xAxis=xg, yAxis=yg, cMap=Hz_Amp, pngFile="Hz_Amp.png" )
