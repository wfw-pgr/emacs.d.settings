
import numpy as np
import vtk
from vtk.util import numpy_support

arr0 = np.linspace( 0.0, 1.0, 101 )
arr1 = arr0
arr2 = arr0**2
arr3 = arr0**2
arr4 = arr0**2

arr = np.array([[ ... ]])
vtkarr = numpy_support.numpy_to_vtk( arr, deep=True, array_type=vtk.VTK_DOUBLE )

# create the vtkTable object
tab = vtk.vtkTable()
tab.GetRowData().AddArray(vtkarr)



def make_spreadsheet( column_names, table ):
    # column_names is a list of strings
    # table is a 2D numpy.ndarray
    # returns a vtkTable object that stores the table content

    # Create a vtkTable to store the output.
    rows = table.shape[0]

    if (table.shape[1] != len(column_names)):
        print('Warning: table number of columns differs from number of '
              'column names')
        return

    from vtk import vtkTable, vtkFloatArray
    vtk_table = vtkTable()
    for (column, name) in enumerate(column_names):
        array = vtkFloatArray()
        array.SetName(name)
        array.SetNumberOfComponents(1)
        array.SetNumberOfTuples(rows)
        vtk_table.AddColumn(array)

        for row in range(0, rows):
            array.InsertValue(row, table[row, column])

    return vtk_table
